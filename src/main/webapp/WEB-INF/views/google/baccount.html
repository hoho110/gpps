<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="width=device-width, initial-scale=1 user-scalable=no">
<title>政采贷>我的帐户</title>

<!-- Bootstrap -->
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/index/justified-nav.css" rel="stylesheet">
<link href="css/plugins/morris/morris-0.4.3.min.css" rel="stylesheet">

<link href="css/mine.css" rel="stylesheet">
<link href="css/plugins/dataTables/jquery.dataTables.css" rel="stylesheet">

<link href="css/plist/a.css" rel="stylesheet">
    <link href="css/plist/creditlevel.css" rel="stylesheet">
    <link href="css/plist/progressbar.css" rel="stylesheet">
<link href="css/myaccount/myaccount.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
      <script src="js/cdn/html5shiv.min.js"></script>
      <script src="js/cdn/respond.min.js"></script>
    <![endif]-->
    
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	<script src="js/jquery.min.js"></script>
	<!-- Include all compiled plugins (below), or include individual files as needed -->
	<script src="js/bootstrap.min.js"></script>
	
	
	<script src="js/jquery.dataTables.js"></script>
	<script src="js/tool.js"></script>
	<script src="js/data.js"></script>
	
	<script type="text/javascript"
		src="/resources/EasyServiceClientFullZ.js"></script>
	<script type="text/javascript"
		src="/easyservice/gpps.service.ILenderService?json"></script>
	<script type="text/javascript"
		src="/easyservice/gpps.dao.IBorrowerAccountDao?json"></script>
	<script type="text/javascript"
				src="/easyservice/gpps.service.IBorrowerService?json"></script>
	<script type="text/javascript"
		src="/easyservice/gpps.service.IAccountService?json"></script>
	<script type="text/javascript"
        src="/easyservice/gpps.service.ISubmitService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.IPayBackService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.IGovermentOrderService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.dao.IGovermentOrderDao?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.IProductService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.IHelpService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.ILetterService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.INoticeService?json"></script>
	<script type="text/javascript"
        src="/easyservice/gpps.service.thirdpay.IThirdPaySupportService?json"></script>
	<script src="js/baccount.js"></script>
	<script src="js/getuser.js"></script>
	
	<script>
	var name = "";
	if (cuser == null && buser == null) {
		window.location.href = "login.html";
	}else if(buser==null){
		window.location.href="myaccount.html";
	}
	else {
		name = buser.name == null ? buser.loginId
				: buser.name;
	}
	</script>


<style type="text/css">
a.accordion-toggle {
	text-decoration: none;
	cursor: pointer;
}

.panel-heading a {
	font-size: 18px;
	font-weight: bold;
	color: black;
}

#path {
	font-size: 14px;
	font-weight: bold;
	color: red;
}
</style>


</head>
<body>
	
	<div id="whole" class="container-fluid">
	
	<div class="row" id="header" style="padding-left:15px; padding-right:15px;">
      
      </div>
	
		<div class="row" style="margin-top:5px;">
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">


				<div class="row">
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
						<div id="account_total" class="col-xs-8 col-md-8"
							style="BACKGROUND-COLOR: #fef9f1; padding-top: 10px;">
							<div class="col-xs-7 col-md-7">
								<div>
									<strong id="welcome"></strong> <a
										style="margin-left: 50px;" href="resetbpsw.html">修改密码</a> <a
										style="margin-left: 20px;" href="quit.html">退出</a>
								</div>
								
								<div style="margin-top: 25px;">
									<span class="grey">企业名称：<span class="orange" id="companyname"></span>
									</span>
								</div>
								
								<div style="margin-top: 5px;">
									<span class="grey">营业执照：<span class="orange" id="license"></span>
									</span>
								</div>

								<div style="margin-top: 7px;">
									<span class="grey">总资产 ： <span class="green" id="total"></span>元
									</span> &nbsp;&nbsp;|&nbsp;&nbsp; <span class="grey">可用余额：<span
										class="green" id="usable"></span>元
									</span>
								</div>


								<div style="margin-top: 5px;">
									<span class="grey">冻结金额：<span class="freeze" id="freeze"></span>元
									</span>
								</div>
							</div>
							
							
							<div class="col-xs-5 col-md-5">
								<div style="margin-top: 5px;">
									<span class="grey">开户银行：<span class="grey" id="bankname"></span>
									</span>
									<div style="clear:both;"></div>
								</div>
								<div style="margin-top: 5px;">
									<span class="grey">开户卡号：<span class="grey" id="bankcard"></span>
									</span>
									<div style="clear:both;"></div>
								</div>
								
								<div style="margin-top: 15px;">
									<span class="grey">钱多多账户：<span class="grey" id="tpaccount"></span>
									</span><button id="loginmmm" style="float:right;">登录钱多多</button>
									<div style="clear:both;"></div>
								</div>
								
								<div style="margin-top: 5px;">
									<span class="grey">授权还款：<span class="grey" id="giveauth"></span>
									</span><button id="togive" style="float:right;">授权</button>
									<div style="clear:both;"></div>
								</div>
							</div>
							
							
							<div class="col-xs-12 col-md-12">
								<div class="btn-group btn-group-lg  btn-group-justified"
									style="padding-bottom: 5px; margin-top: 10px;">
									<div class="btn-group">
										<a class="btn btn-success btn-lg" href="recharge.html" target="_blank" id="recharge">充值</a>
									</div>
									<div class="btn-group">
										<a class="btn btn-default btn-lg" href="cashout.html" target="_blank" id="cashout">提现</a>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xs-4 col-md-4">
							<div class="col-xs-4 col-md-4" style="padding-top: 20px;">
								<img src="img/phone.jpg" style="width: 80px; height: 100px;"></img>
								<div
									style="color: green; font-size: 12px; font-weight: bold; margin-top: 5px; z-index: 1000">
									<span class="glyphicon glyphicon-ok"></span> 手机已绑定
								</div>
							</div>
							<div class="col-xs-4 col-md-4" style="padding-top: 20px;">
								<a id="identity" title="" href="#"><img
									id="identity" src="img/people.png"
									style="width: 80px; height: 100px;"></img></a>
								<div id="identity"
									style="color: red; font-size: 12px; font-weight: bold; margin-top: 5px;">
									
								</div>
							</div>
							<div class="col-xs-4 col-md-4" style="padding-top: 20px;">
								<a id="spsw" title="点击开通第三方账户" href="#" data-sk='none'><img
									id="spsw" src="img/sanfang_n.jpg"
									style="width: 80px; height: 100px;"></img></a>
								<div id="spsw"
									style="color: red; font-size: 12px; font-weight: bold; margin-top: 5px;">
									<span class="glyphicon glyphicon-remove"></span> 第三方账户未开通
								</div>
								<div id="spswformdiv" style="display:none">
								</div>
							</div>
						</div>
						<div style="clear: both;"></div>
					</div>
				</div>


				<div class="row">
					<div class="col-xs-2 col-md-2" style="padding-right: 0px;">


						<div class="btn-group-vertical"
							style="width: 100%; margin-top: 42px;">
							<button type="button" id="bcenter"
								class="btn nav-first btn-default btn-lg">企业中心</button>
							<button type="button" id="request"
								class="btn nav-first btn-default btn-lg">融资申请</button>
							<button type="button" id="order"
								class="btn nav-first btn-default btn-lg">订单查看</button>
							<button type="button" id="payback"
								class="btn nav-first btn-default btn-lg">还款查看</button>
							<button type="button" id="cash"
								class="btn nav-first btn-default btn-lg">资金查看</button>
						</div>

					</div>
					<div class="col-xs-10 col-md-10" style="padding-left: 0px;">
						<div class="col-xs-12 col-md-12" id="nav_level2"></div>

						<div class="col-xs-12 col-md-12" id="content"
							style="min-height: 400px; border: #eee solid 1px;"></div>

					</div>
				</div>






			</div>
		</div>
		
		
		<div class="row foot" id="footer" style="border: #eee solid 1px; background:#eee; min-height:120px; font-size:13px; margin-top:5px; margin-left: 0px; margin-right:0px;">

	</div>
		
		
	</div>



<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">还款</h4>
      </div>
      <div class="modal-body">
      			还款完成前请不要关闭该对话框，在支付完毕后点击相应的操作以完成还款。
      </div>
      <div class="modal-footer">
        <button id="paysuccess" type="button" class="btn btn-primary" data-dismiss="modal">还款成功</button>
        <button id="payfail" type="button" class="btn btn-default">还款失败</button>
      </div>
    </div>
  </div>
</div>



<!-- Modal -->
<div class="modal fade" id="repaydetail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">回款详情</h4>
      </div>
      <div class="modal-body" id="rdetail">
      			
      </div>
      <div class="modal-footer">
        
      </div>
    </div>
  </div>
</div>


<!-- Modal -->
<div class="modal fade" id="noticedetail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="nlabel"></h4>
      </div>
      <div class="modal-body" id="ndetail">
      			
      </div>
      <div class="modal-footer">
        <button id="nclose" type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>


<!-- Modal -->
<div class="modal fade" id="letterdetail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">站内信</h4>
      </div>
      <div class="modal-body" id="ldetail">
      			
      </div>
      <div class="modal-footer">
        <button id="lclose" type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>

<div id="cardBindingformdiv" style="display:none;"></div>
<div id="spswformdiv" style="display:none;"></div>
<div id="authformdiv" style="display:none;"></div>





	
        <script src="js/head.js"></script>
		<script src="js/foot.js"></script>
	<script>
		$(document).ready(function() {
							
							header('myaccount');
							
							var fid = getQueryString('fid');
							var sid = getQueryString('sid');

							var accountDao = EasyServiceClient
									.getRemoteProxy("/easyservice/gpps.dao.IBorrowerAccountDao");
							
							
							$('#welcome').html(greet() + name);

							var account = accountDao.find(buser.accountId);
							var total = account.total;
							$('#total').html(total.value);

							var usable = account.usable;
							$('#usable').html(usable.value);

							var freeze = account.freeze;
							$('#freeze').html(freeze.value);

							var used = 0;
							$('#used').html(used);

							var totalincome = 0;
							$('#totalincome').html(totalincome);
							
							$('#companyname').html(buser.companyName);
							$('#license').html(buser.license);
							
							
							var cardBinding = buser.cardBinding;
							if(cardBinding != null){
								$('#bankname').html(cardBinding.branchBankName);
								$('#bankcard').html(cardBinding.cardNo);
								
							}else{
								$('#bankname').html('暂未绑定');
								$('#bankcard').html('暂未绑定');
								
							}
							
							var authorizeTypeOpen = buser.authorizeTypeOpen;
							if(authorizeTypeOpen!=2){
								$('#giveauth').html('未授权');
								$('#togive').click(function(e){
									$('#authformdiv').empty();
									var service = EasyServiceClient.getRemoteProxy("/easyservice/gpps.service.thirdpay.IThirdPaySupportService");
                                    var auth=service.getAuthorize();
                                    var content="<form id='authform' action='"+auth.baseUrl+"'method='post' target='_blank'>";
                                    for(var o in auth)
                                   	{
                                        if(o=="baseUrl"||o=="_i_"||o=="_t_")
                                       	{
                                        	continue;
                                       	}
                                        var len = o.length;
                                        var name=o.substring(0,1).toUpperCase() + o.substring(1,len); 
                                        content+="<input id='"+name+"' name='"+name+"' value='"+auth[o]+"'/> ";
                                   	}
                                    content+="</form>";
                                    $('#authformdiv').html(content);
                                    $('#authform').submit();
								});
							}else{
								$('#giveauth').html('已授权');
								$('#togive').attr('disabled', 'disabled');
							}


							var privilege = buser.privilege;
							if (privilege == 10) {
								$('img#identity').attr('src', 'img/people.png').attr('title', '点击申请').attr('disabled', 'disabled');
								$('a#identity').attr('href', '#');
								$('div#identity').css('color', 'red')
										.html('<span class="glyphicon glyphicon-remove"></span>未申请实地考察')
								$('a#identity').click(function(e){
									if(confirm('马上申请实地考察?')){
									bservice.applyForFunding();
									$('div#identity').css('color', 'red')
									.html('<span class="glyphicon glyphicon-remove"></span>待实地考察');
									}
								})
							}else if(privilege==14){

								$('img#identity').attr('src', 'img/people.png').attr('title', '点击申请').attr('disabled', 'disabled');
								$('a#identity').attr('href', '#');
								$('div#identity').css('color', 'red')
										.html('<span class="glyphicon glyphicon-remove"></span>审核未通过');
								$('a#identity').click(function(e){
									if(confirm('马上申请实地考察?')){
									bservice.applyForFunding();
									$('div#identity').css('color', 'red')
									.html('<span class="glyphicon glyphicon-remove"></span>待实地考察');
									}
								})
							}
							else if(privilege==11){
								$('img#identity').attr('src', 'img/people.png').attr('title', '待实地考察').attr('disabled', 'disabled');
								$('a#identity').attr('href', '#');
								$('div#identity').css('color', 'red')
										.html('<span class="glyphicon glyphicon-remove"></span>待实地考察')
							}else if(privilege==12){
								$('img#identity').attr('src', 'img/people.jpg').attr('title', '实地考察已完成').attr('disabled', 'disabled');
								$('a#identity').attr('href', '#');
								$('div#identity').css('color', 'green')
										.html('<span class="glyphicon glyphicon-ok"></span>实地考察已完成')
							}

							var spsw = buser.thirdPartyAccount;
							if (spsw != null && spsw != "") {
								$('#tpaccount').html(spsw);
								$('#loginmmm').click(function(e){
									window.open('http://218.4.234.150:88/main');
								})
								
								
								$('img#spsw').attr('src', 'img/sanfang.jpg').attr('title', '第三方账户已开通').attr('disabled', 'disabled');
								$('a#spsw').attr('href', '#').attr('data-sk',
										'done');
								$('div#spsw').css('color', 'green')
										.html('<span class="glyphicon glyphicon-ok"></span>第三方账户已开通')
							}else{
								$('#tpaccount').html("暂未开通");
								$('#loginmmm').html('马上注册');
								
								if(privilege==12)
								{
								$('#loginmmm').click(function(e){
									$('#spswformdiv').empty();
									var service = EasyServiceClient.getRemoteProxy("/easyservice/gpps.service.thirdpay.IThirdPaySupportService");
                                    var registAccount=service.getRegistAccount();
                                    var content="<form id='spswform' action='"+registAccount.baseUrl+"'method='post'>";
                                    for(var o in registAccount)
                                   	{
                                        if(o=="baseUrl")
                                       	{
                                        	continue;
                                       	}
                                        var len = o.length;
                                        var name=o.substring(0,1).toUpperCase() + o.substring(1,len); 
                                        content+="<input id='"+name+"' name='"+name+"' value='"+registAccount[o]+"'/> ";
                                   	}
                                    content+="</form>";
                                    $('#spswformdiv').html(content);
                                    $('#spswform').submit();
								});
								}
							}

							
							if(privilege==12)
							{
							$('a#spsw').click(
											function(e) {
												if ($(this).attr('data-sk') == 'done') {
													return;
												}
												//window.location.href = "/account/thirdPartyRegist/request";
												var service = EasyServiceClient.getRemoteProxy("/easyservice/gpps.service.thirdpay.IThirdPaySupportService");
                                                var registAccount=service.getRegistAccount();
                                                var content="<form id='spswform' action='"+registAccount.baseUrl+"'method='post' target='_blank'>";
                                                for(var o in registAccount)
                                               	{
                                                    if(o=="baseUrl")
                                                   	{
                                                    	continue;
                                                   	}
                                                    var len = o.length;
                                                    var name=o.substring(0,1).toUpperCase() + o.substring(1,len); 
                                                    content+="<input id='"+name+"' name='"+name+"' value='"+registAccount[o]+"'/> ";
                                               	}
                                                content+="</form>";
                                                $('#spswformdiv').html(content);
                                                $('#spswform').submit();
											});
							}
							
							
							if (spsw != null && spsw != "") {
							$('button#rebind').click(
									function(e) {
										$('#cardBindingformdiv').empty();
										var service = EasyServiceClient.getRemoteProxy("/easyservice/gpps.service.thirdpay.IThirdPaySupportService");
                                        var cardBinding=service.getCardBinding();
                                        var content="<form id='cardBindingform' action='"+cardBinding.baseUrl+"'method='post' target='_blank'>";
                                        for(var o in cardBinding)
                                       	{
                                            if(o=="baseUrl"||o=="_i_"||o=="_t_")
                                           	{
                                            	continue;
                                           	}
                                            var len = o.length;
                                            var name=o.substring(0,1).toUpperCase() + o.substring(1,len); 
                                            content+="<input id='"+name+"' name='"+name+"' value='"+cardBinding[o]+"'/> ";
                                       	}
                                        content+="</form>";
                                        $('#cardBindingformdiv').html(content);
                                        $('#cardBindingform').submit();
									});
							}
							
							

							$('button.nav-first').click(function(e) {
												$('button.nav-first').removeClass(
														'active');
												$(this).addClass('active');
												var content = createBorrowerNavLevel2($(
														this).attr('id'));
												content.css('float', 'right');
												content.css('margin-right',
														'-15px');
												$('#nav_level2').html('');
												$('#nav_level2')
														.append(content);
												$('#nav_level2')
														.append(
																'<div style="clear:both;"></div>');

												$('ul.nav-second li a').on('click',function(e) {
																	$('ul.nav-second li')
																			.removeClass(
																					'active');
																	$(this)
																			.parent()
																			.addClass('active');

																	var ff = bnav2funtion[$(this).attr('data-sk')];

																	if (ff == null) {
																		$('div#content').html($(this).attr('data-sk'));
																	} else if (typeof (ff) == "function") {
																		$('div#content').html('');
																		ff($('div#content'));
																	}
																	
																	
																});
													$('ul.nav-second li a').first().trigger('click');
											});
							if(fid!=null){
								$('#'+fid).trigger('click');
								if(sid!=null)
									$('ul.nav-second li a[data-sk="'+sid+'"]').trigger('click');
								else
									$('ul.nav-second li a').first().trigger('click');
								
							}else{
								$('#bcenter').trigger('click');
							}
							
							$('#paysuccess').click(function(e){
									window.location.href = "baccount.html?fid=payback&sid=payback-have";
							});
							
							$('#payfail').click(function(e){
									window.location.href = "baccount.html?fid=payback&sid=payback-canpay";
							});
						});
	</script>
</body>
</html>