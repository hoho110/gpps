<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="width=device-width, initial-scale=1 user-scalable=no">
<title>政采贷>我的帐户</title>

<!-- Bootstrap -->
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/index/justified-nav.css" rel="stylesheet">
<link href="css/plugins/morris/morris-0.4.3.min.css" rel="stylesheet">

<link href="css/mine.css" rel="stylesheet">
<link href="css/plugins/dataTables/jquery.dataTables.css" rel="stylesheet">

<link href="css/plist/a.css" rel="stylesheet">
<link href="css/myaccount/myaccount.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
      <script src="js/cdn/html5shiv.min.js"></script>
      <script src="js/cdn/respond.min.js"></script>
    <![endif]-->
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>

<script src="js/plugins/morris/raphael-2.1.0.min.js"></script>
	<script src="js/plugins/morris/morris.js"></script>
	<script src="js/jquery.dataTables.js"></script>
	<script src="js/tool.js"></script>
	
	
	<script type="text/javascript"
		src="/resources/EasyServiceClientFullZ.js"></script>
	<script type="text/javascript"
		src="/easyservice/gpps.service.ILenderService?json"></script>
	<script type="text/javascript"
		src="/easyservice/gpps.dao.ILenderAccountDao?json"></script>
	<script type="text/javascript"
				src="/easyservice/gpps.service.IBorrowerService?json"></script>
	<script type="text/javascript"
		src="/easyservice/gpps.service.IAccountService?json"></script>
	<script type="text/javascript"
        src="/easyservice/gpps.service.ISubmitService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.IPayBackService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.ILetterService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.dao.ILetterDao?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.INoticeService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.IHelpService?json"></script>
    <script type="text/javascript"
        src="/easyservice/gpps.service.IActivityRefService?json"></script>
    <script src="js/getuser.js"></script>
    <script src="js/data.js"></script>
    <script src="js/myaccount.js"></script>
    
    <script type="text/javascript"
        src="/easyservice/gpps.service.thirdpay.IThirdPaySupportService?json"></script>
    
    <script>
    var name = "";
    if (cuser == null && buser == null) {
		window.location.href = "login.html";
	}else if(cuser==null){
		window.location.href="baccount.html";
	}
	else {
		name = cuser.name == null ? cuser.loginId
				: cuser.name;
	}
    
    </script>

<style type="text/css">
a.accordion-toggle {
	text-decoration: none;
	cursor: pointer;
}

.panel-heading a {
	font-size: 18px;
	font-weight: bold;
	color: black;
}

#path {
	font-size: 14px;
	font-weight: bold;
	color: red;
}
</style>


</head>
<body>
	
	<div id="whole" class="container-fluid">
	
	<div class="row" id="header" style="padding-left:15px; padding-right:15px;">
      
      </div>
	
		<div class="row" style="margin-top:5px;">
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">


				<div class="row">
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
						<div id="account_total" class="col-xs-12 col-sm-12 col-md-8"
							style="BACKGROUND-COLOR: #fef9f1; padding-top: 10px;">
							
							<div class="col-xs-12 col-md-7">
								<div>
									<strong id="welcome"></strong> <a
										style="margin-left: 50px;" href="resetpsw.html">修改密码</a> <a
										style="margin-left: 20px;" href="quit.html">退出</a>
								</div>

								<div style="margin-top: 25px;">
									<span class="grey">总资产 ： <span class="green" id="total"></span>元
									</span> &nbsp;&nbsp;|&nbsp;&nbsp; <span class="grey">可用余额：<span
										class="green" id="usable"></span>元
									</span>
								</div>


								<div style="margin-top: 5px;">
									<span class="grey">冻结金额：<span class="freeze" id="freeze"></span>元
									</span>&nbsp;&nbsp;|&nbsp;&nbsp; <span class="grey">已投金额：<span
										class="orange" id="used"></span>元
									</span>
								</div>


								<div style="margin-top: 5px;">
									<span class="grey">已获利息：<span class="orange"
										id="totalincome"></span>元
									</span>
								</div>
								
								</div>
								
								<div class="col-xs-12 col-md-5">
								<div style="margin-top: 15px;">
									<span class="grey">身份证号：<span class="grey" id="idcard"></span>
									</span><button id="bindidcard" style="float:right;">身份证绑定</button>
									<div style="clear:both;"></div>
								</div>
								<div style="margin-top: 5px;">
									<span class="grey">钱多多账户：<span class="grey" id="tpaccount"></span>
									</span><button id="loginmmm" style="float:right;">登录钱多多</button>
									<div style="clear:both;"></div>
								</div>
								<div style="margin-top: 5px;">
									<span class="grey">绑定银行卡：<span class="grey" id="bankcard"></span>
									</span><button id="rebind" style="float:right;">绑定</button>
									<div style="clear:both;"></div>
								</div>
							</div>
							<div class="col-xs-12 col-md-12">
								<div class="btn-group btn-group-lg  btn-group-justified"
									style="padding-bottom: 5px; margin-top: 10px;">
									<div class="btn-group">
										<a class="btn btn-success btn-lg" href="recharge.html" target="_blank" id="recharge">充值</a>
									</div>
									<div class="btn-group">
										<a class="btn btn-default btn-lg" href="cashout.html" target="_blank" id="cashout">提现</a>
									</div>
								</div>
							</div>
						</div>
						
						<div class="col-xs-12 col-sm-12 col-md-4">
							<div class="col-xs-4 col-md-3" style="padding-top: 20px;">
								<img src="img/phone.jpg" style="width: 80px; height: 100px;"></img>
								<div
									style="color: green; font-size: 12px; font-weight: bold; margin-top: 5px; z-index: 1000">
									<span class="glyphicon glyphicon-ok"></span> 手机已绑定
								</div>
							</div>
							<div class="col-xs-4 col-md-3" style="padding-top: 20px;">
								<a id="identity" title="点击绑定身份证" href="register2.html"><img
									id="identity" src="img/people.png"
									style="width: 80px; height: 100px;"></img></a>
								<div id="identity"
									style="color: red; font-size: 12px; font-weight: bold; margin-top: 5px;">
									<span class="glyphicon glyphicon-remove"></span> 身份证未绑定
								</div>
							</div>
							<div class="col-xs-4 col-md-3" style="padding-top: 20px;">
								<a id="spsw" title="点击开通第三方账户" href="#" data-sk='none'><img
									id="spsw" src="img/sanfang_n.jpg"
									style="width: 80px; height: 100px;"></img></a>
								<div id="spsw"
									style="color: red; font-size: 12px; font-weight: bold; margin-top: 5px;">
									<span class="glyphicon glyphicon-remove"></span> 第三方账户未开通
								</div>
								<div id="spswformdiv" style="display:none">
								</div>
							</div>
							
							<div id="cardBindingformdiv" style="display:none;"></div>
							
						</div>
						<div style="clear: both;"></div>
					</div>
				</div>


				<div class="row">
					<div class="col-xs-2 col-md-2" style="padding-right: 0px;">


						<div class="btn-group-vertical"
							style="width: 100%; margin-top: 42px;">
							<button type="button" id="mycenter"
								class="btn nav-first btn-default btn-lg">会员中心</button>
							<button type="button" id="submit"
								class="btn nav-first btn-default btn-lg">投资查看</button>
							<button type="button" id="payback"
								class="btn nav-first btn-default btn-lg">回款查看</button>
							<button type="button" id="cash"
								class="btn nav-first btn-default btn-lg">资金查看</button>
							<button type="button" id="tools"
								class="btn nav-first btn-default btn-lg">工具分析</button>
							<button type="button" id="letter"
								class="btn nav-first btn-default btn-lg">站内信</button>
						</div>

					</div>
					<div class="col-xs-10 col-md-10" style="padding-left: 0px;">
						<div class="col-xs-12 col-md-12" id="nav_level2"></div>

						<div class="col-xs-12 col-md-12" id="content"
							style="min-height: 400px; border: #eee solid 1px;"></div>

					</div>
				</div>






			</div>
		</div>
		
		
		<div class="row foot" id="footer" style="border: #eee solid 1px; background:#eee; min-height:120px; font-size:13px; margin-top:5px; margin-left: 0px; margin-right:0px;">

	</div>
		
		
	</div>



<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">投资标的支付</h4>
      </div>
      <div class="modal-body">
      			投资标的支付完成前请不要关闭该对话框，在支付完毕后点击相应的操作以完成支付。
      </div>
      <div class="modal-footer">
        <button id="success" type="button" class="btn btn-primary" data-dismiss="modal">支付成功</button>
        <button id="fail" type="button" class="btn btn-default">支付失败</button>
      </div>
    </div>
  </div>
</div>

<div id="buyformdiv" style="display:none;"></div>

<!-- Modal -->
<div class="modal fade" id="repaydetail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">回款详情</h4>
      </div>
      <div class="modal-body" id="rdetail">
      			
      </div>
      <div class="modal-footer">
        
      </div>
    </div>
  </div>
</div>


<!-- Modal -->
<div class="modal fade" id="letterdetail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">站内信</h4>
      </div>
      <div class="modal-body" id="ldetail">
      			
      </div>
      <div class="modal-footer">
        <button id="lclose" type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>


<!-- Modal -->
<div class="modal fade" id="noticedetail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="nlabel">站内信</h4>
      </div>
      <div class="modal-body" id="ndetail">
      			
      </div>
      <div class="modal-footer">
        <button id="nclose" type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>

        <script src="js/head.js"></script>
		<script src="js/foot.js"></script>
	<script>
		$(document).ready(function() {
							
							header('myaccount');
							
							var fid = getQueryString('fid');
							var sid = getQueryString('sid');

							var accountDao = EasyServiceClient.getRemoteProxy("/easyservice/gpps.dao.ILenderAccountDao");
							{
								
								$('button#letter').html('站内信('+lettercount+')');
							}
							
							
							$('#welcome').html(greet() + name+'<a href="javascript:void(0);" id="inner_letter"><span class="glyphicon glyphicon-envelope" style="margin-left:10px; color=red"></span>'+lettercount+'</a>');
							

							var account = accountDao.find(cuser.accountId);
							var total = account.total;
						//	$('#total').html((parseFloat(total.value)+0.09).toFixed(0));
							$('#total').html(total.value);

							var usable = account.usable;
						//	$('#usable').html((parseFloat(usable.value)+0.09).toFixed(0));
							$('#usable').html(usable.value);

							var freeze = account.freeze;
						//	$('#freeze').html((parseFloat(freeze.value)+0.09).toFixed(0));
							$('#freeze').html(freeze.value);

							var used = account.used;
						//	$('#used').html((parseFloat(used.value)+0.09).toFixed(0));
							$('#used').html(used.value);

							var totalincome = account.totalincome;
						//	$('#totalincome').html((parseFloat(totalincome.value)+0.09).toFixed(0));
							$('#totalincome').html(totalincome.value);
							
							var cardBinding = cuser.cardBinding;
							if(cardBinding != null){
								$('#bankcard').html(cardBinding.cardNo);
								$('#rebind').html('重新绑定');
							}else{
								$('#bankcard').html('暂未绑定');
								$('#rebind').html('绑定');
							}
							


							var identity = cuser.identityCard;
							if (identity != null && identity != "") {
								$('#idcard').html(identity);
								$('#bindidcard').html('已绑定');
								$('#bindidcard').attr('disabled', 'disabled');
								$('img#identity').attr('src', 'img/people.jpg').attr('title', '身份证已绑定').attr('disabled', 'disabled');
								$('a#identity').attr('href', '#');
								$('div#identity')
										.css('color', 'green')
										.html(
												'<span class="glyphicon glyphicon-ok"></span>身份证已绑定')
							}else{
								$('#idcard').html('暂未绑定');
								$('#bindidcard').click(function(){
									window.location.href = 'register2.html';
								});
							}

							var spsw = cuser.thirdPartyAccount;
							
							if (spsw != null && spsw != "") {
								$('#tpaccount').html(spsw);
								$('#loginmmm').click(function(e){
									window.open('http://218.4.234.150:88/main');
								})
								$('img#spsw').attr('src', 'img/sanfang.jpg').attr('title', '第三方账户已开通').attr('disabled', 'disabled');
								$('a#spsw').attr('href', '#').attr('data-sk',
										'done');
								$('div#spsw')
										.css('color', 'green')
										.html(
												'<span class="glyphicon glyphicon-ok"></span>第三方账户已开通')
							}else{
								$('#tpaccount').html("暂未开通");
								$('#loginmmm').html('马上注册');
								
								if(identity!=null && identity!="")
								{
								$('#loginmmm').click(function(e){
									$('#spswformdiv').empty();
									var service = EasyServiceClient.getRemoteProxy("/easyservice/gpps.service.thirdpay.IThirdPaySupportService");
                                    var registAccount=service.getRegistAccount();
                                    var content="<form id='spswform' action='"+registAccount.baseUrl+"'method='post'>";
                                    for(var o in registAccount)
                                   	{
                                        if(o=="baseUrl")
                                       	{
                                        	continue;
                                       	}
                                        var len = o.length;
                                        var name=o.substring(0,1).toUpperCase() + o.substring(1,len); 
                                        content+="<input id='"+name+"' name='"+name+"' value='"+registAccount[o]+"'/> ";
                                   	}
                                    content+="</form>";
                                    $('#spswformdiv').html(content);
                                    $('#spswform').submit();
								});
								}
							}

							
							if(identity!=null && identity!="")
							{
							$('a#spsw').click(
											function(e) {
												if ($(this).attr('data-sk') == 'done') {
													return;
												}
												//window.location.href = "/account/thirdPartyRegist/request";
												$('#spswformdiv').empty();
												var service = EasyServiceClient.getRemoteProxy("/easyservice/gpps.service.thirdpay.IThirdPaySupportService");
                                                var registAccount=service.getRegistAccount();
                                                var content="<form id='spswform' action='"+registAccount.baseUrl+"'method='post' target='_blank'>";
                                                for(var o in registAccount)
                                               	{
                                                    if(o=="baseUrl")
                                                   	{
                                                    	continue;
                                                   	}
                                                    var len = o.length;
                                                    var name=o.substring(0,1).toUpperCase() + o.substring(1,len); 
                                                    content+="<input id='"+name+"' name='"+name+"' value='"+registAccount[o]+"'/> ";
                                               	}
                                                content+="</form>";
                                                $('#spswformdiv').html(content);
                                                $('#spswform').submit();
											});
							}
							
							
							
							
							if (spsw != null && spsw != "") {
							$('button#rebind').click(
									function(e) {
										$('#cardBindingformdiv').empty();
										var service = EasyServiceClient.getRemoteProxy("/easyservice/gpps.service.thirdpay.IThirdPaySupportService");
                                        var cardBinding=service.getCardBinding();
                                        var content="<form id='cardBindingform' action='"+cardBinding.baseUrl+"'method='post' target='_blank'>";
                                        for(var o in cardBinding)
                                       	{
                                            if(o=="baseUrl"||o=="_i_"||o=="_t_")
                                           	{
                                            	continue;
                                           	}
                                            var len = o.length;
                                            var name=o.substring(0,1).toUpperCase() + o.substring(1,len); 
                                            content+="<input id='"+name+"' name='"+name+"' value='"+cardBinding[o]+"'/> ";
                                       	}
                                        content+="</form>";
                                        $('#cardBindingformdiv').html(content);
                                        $('#cardBindingform').submit();
									});
							
							}
							
							
							
							$('button.nav-first').click(function(e) {
												$('button.nav-first').removeClass(
														'active');
												$(this).addClass('active');
												var content = createNavLevel2($(
														this).attr('id'));
												content.css('float', 'right');
												content.css('margin-right',
														'-15px');
												$('#nav_level2').html('');
												$('#nav_level2')
														.append(content);
												$('#nav_level2')
														.append(
																'<div style="clear:both;"></div>');

												$('ul.nav-second li a').on('click',function(e) {
																	$('ul.nav-second li')
																			.removeClass(
																					'active');
																	$(this)
																			.parent()
																			.addClass(
																					'active');

																	var ff = nav2funtion[$(this).attr('data-sk')];

																	if (ff == null) {
																		$('div#content').html($(this).attr('data-sk'));
																	} else if (typeof (ff) == "function") {
																		$('div#content').html('');
																		ff($('div#content'));
																	} else if (ff == "tools-receive-statistics") {
																		$('div#content').html('');
																		$(
																				'<div id="morris-bar-chart"></div>')
																				.appendTo(
																						'div#content');
																		Morris
																				.Bar({
																					element : 'morris-bar-chart',
																					data : [
																							{
																								y : '2014-7',
																								a : 26
																							},
																							{
																								y : '2014-8',
																								a : 62
																							},
																							{
																								y : '2014-9',
																								a : 80
																							},
																							{
																								y : '2014-10',
																								a : 132
																							},
																							{
																								y : '2014-11',
																								a : 502.7
																							},
																							{
																								y : '2014-12',
																								a : 12
																							},
																							{
																								y : '2015-1',
																								a : 23
																							},
																							{
																								y : '2015-2',
																								a : 0
																							},
																							{
																								y : '2015-3',
																								a : 309.21
																							},
																							{
																								y : '2015-4',
																								a : 0
																							},
																							{
																								y : '2015-5',
																								a : 0
																							},
																							{
																								y : '2015-6',
																								a : 0
																							} ],
																					xkey : 'y',
																					ykeys : [ 'a' ],
																					labels : [ '回款金额' ],
																					hideHover : 'auto',
																					resize : true
																				});
																	} else if (ff == "tools-fluxility") {
																		$(
																				'div#content')
																				.html(
																						'');
																		var message = $(
																				'<div class="col-xs-3 col-md-3"></div>')
																				.appendTo(
																						'div#content');
																		message
																				.html('可用金额：200<br>1个月内：50<br>1-2个月：30<br>2-3个月：300<br>3-6个月：200<br>6-12个月：200<br>12个月以上20');
																		$(
																				'<div class="col-xs-9 col-md-9"><div id="morris-donut-analysis"></div></div>')
																				.appendTo(
																						'div#content');
																		Morris.Donut({
																					element : 'morris-donut-analysis',
																					data : [
																							{
																								label : "可用",
																								value : 200
																							},
																							{
																								label : "1个月内",
																								value : 50
																							},
																							{
																								label : "1-2个月",
																								value : 30
																							},
																							{
																								label : "2-3个月",
																								value : 300
																							},
																							{
																								label : "3-6个月",
																								value : 200
																							},
																							{
																								label : "6-12个月",
																								value : 200
																							},
																							{
																								label : "12个月以上",
																								value : 20
																							} ],
																					resize : true
																				});
																	}
																	
																	
																	
																	$('button.readletter').click(function(e){
																		
																	});
																	
																	$('a.submittoafford').click(function(e){
																		$('#myModal').modal({
																			  keyboard: false,
																			  backdrop: false
																		});
																		
																		
																		
																		
																		try{
																			var submitService = EasyServiceClient.getRemoteProxy("/easyservice/gpps.service.ISubmitService");
																	 		var submit = submitService.find(parseInt($(this).attr('id')));
																	 		
																	 		
																	 		var service = EasyServiceClient.getRemoteProxy("/easyservice/gpps.service.thirdpay.IThirdPaySupportService");
																	        var transfer=service.getTransferToBuy(submit.id,''+submit.productId);
																	        var content="<form id='buyform' action='"+transfer.baseUrl+"'method='post' target='_blank'>";
																	        for(var o in transfer)
																	       	{
																	            if(o=="baseUrl")
																	           	{
																	            	continue;
																	           	}
																	            var len = o.length;
																	            var name=o.substring(0,1).toUpperCase() + o.substring(1,len); 
																	            content+="<input id='"+name+"' name='"+name+"' value='"+transfer[o]+"'/> ";
																	       	}
																	        content+="</form>";
																	        $('#buyformdiv').html(content);
																	        $('#buyform').submit();
																	 		
																	 		}catch(e){
																	 			alert(e.message);
																	 		}
																	});
																	
																	
																	
																});
													$('ul.nav-second li a').first().trigger('click');
											});
							if(fid!=null){
								$('#'+fid).trigger('click');
								if(sid!=null)
									$('ul.nav-second li a[data-sk="'+sid+'"]').trigger('click');
								else
									$('ul.nav-second li a').first().trigger('click');
								
							}else{
								$('#submit').trigger('click');
							}
							
							$('#success').click(function(e){
									window.location.href = "myaccount.html?fid=submit&sid=submit-toafford";
							});
							
							$('#fail').click(function(e){
									window.location.href = "myaccount.html?fid=submit&sid=submit-toafford";
							});
							
							$('#inner_letter').click(function(e){
								$('#mycenter').trigger('click');
								$('ul.nav-second li a[data-sk="letter-unread-mycenter"]').trigger('click');
							});
							
							
						});
	</script>
</body>
</html>