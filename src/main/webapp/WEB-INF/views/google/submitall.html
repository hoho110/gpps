<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>政采贷>产品投标详情</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    

    <!-- Custom styles for this template -->
    <link href="css/signin/signin.css" rel="stylesheet">
	<link href="css/plist/a.css" rel="stylesheet">
	
	<link href="css/plugins/dataTables/jquery.dataTables.css" rel="stylesheet">
	
    <script src="js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="js/cdn/html5shiv.min.js"></script>
      <script src="js/cdn/respond.min.js"></script>
    <![endif]-->
    
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.dataTables.js"></script>
		<script type="text/javascript"
				src="/resources/EasyServiceClientFullZ.js"></script>
		<script type="text/javascript"
				src="/easyservice/gpps.service.ILenderService?json"></script>
		<script type="text/javascript"
				src="/easyservice/gpps.service.IBorrowerService?json"></script>
		<script type="text/javascript"
				src="/easyservice/gpps.service.ISubmitService?json"></script>
		<script type="text/javascript"
				src="/easyservice/gpps.service.IMyAccountService?json"></script>
		<script src="js/tool.js"></script>
		<script src="js/getuser.js"></script>
		
		<script>
		if(usertype!='borrower'){
			window.location.href="login.html";
		}
		</script>
  </head>

  <body>

    <div class="container">
		
	<div class="row" id="header" style="padding-left:15px; padding-right:15px;">
      
      </div>
	<div class="row" style="padding-left:15px; padding-right:15px; margin-top:10px; margin-bottom:20px;">
	<div class="col-md-2"></div>
	<div class="col-md-8" id="title">
	
	</div>
	<div class="col-md-2"></div>
	</div>
	<div class="row" style="padding-left:15px; padding-right:15px;">
	<div class="col-md-2"></div>
	<div class="col-md-8">
	<table id="submitall" class="table table-striped table-hover"></table>
	</div>
	<div class="col-md-2"></div>
	</div>	
      
      

    </div> <!-- /container -->


    
  </body>
  
  
  <script src="js/head.js"></script>
  
  <script>
  _defaultDataTableOLanguage = {
			"sProcessing" : "<img src ='images/waiting.gif' height = 18/>正在查询中，请稍后......",
			"sLengthMenu" : "每页 _MENU_ 条记录",
			"sZeroRecords" : "无数据",
			"sInfo" : "当前第 _START_ 到  _END_ 条记录 共_TOTAL_条记录",
			"sInfoEmpty" : " ",
			"sSearch" : "查找： ",
			"oPaginate" : {
				"sFirst" : "首页",
				"sLast" : "末页",
				"sNext" : "下一页",
				"sPrevious" : "上一页"
			},
			"sInfoFiltered" : "(在 _MAX_ 条记录中查找)"
		};

	var defaultSettings = {
					"bServerSide" : true,
					"bAutoWidth" : true,
					"bStateSave" : false, //保存状态到cookie ******很重要 ， 当搜索的时候页面一刷新会导致搜索的消失。使用这个属性设置为true就可避免了 
					"bPaginate" : true, // 是否使用分页
					"bProcessing" : false, //是否显示正在处理的提示 
					"bLengthChange" : true, //是否启用设置每页显示记录数 
					"iDisplayLength" : 10, //默认每页显示的记录数
					"aLengthMenu" : [ 10, 15, 25, 50 ],
					"bFilter" : false, //是否使用搜索 
					"bJQueryUI" : true, //页面风格使用jQuery.
					// "sScrollY": 200,//竖向滚动条 tbody区域的高度
					"sScrollX" : "100%", //横向滚动条 
					"sScrollXInner" : "100%",
					"bScrollCollapse" : true,
					"aoColumns" : [],
					"aaData" : [],
					"sPaginationType": "full_numbers", //分页样式
					"bAutoWidth" : true, //列的宽度会根据table的宽度自适应 
					"bSort" : false, //是否使用排序 
					"aoColumnDefs" : [ {
						"bSortable" : false,
						"aTargets" :["_all"]
					} ],
					"aaSorting" : [ [ 4, "desc" ] ],
					"oLanguage" : _defaultDataTableOLanguage
				};
	var defaultSettings_noCallBack = {
			"bServerSide" : false,
			"bAutoWidth" : true,
			"bStateSave" : false, //保存状态到cookie ******很重要 ， 当搜索的时候页面一刷新会导致搜索的消失。使用这个属性设置为true就可避免了 
			"bPaginate" : true, // 是否使用分页
			"bProcessing" : false, //是否显示正在处理的提示 
			"bLengthChange" : true, //是否启用设置每页显示记录数 
			"iDisplayLength" : 10, //默认每页显示的记录数
			"aLengthMenu" : [ 10, 15, 25, 50 ],
			"bFilter" : false, //是否使用搜索 
			"bJQueryUI" : true, //页面风格使用jQuery.
			// "sScrollY": 200,//竖向滚动条 tbody区域的高度
			"sScrollX" : "100%", //横向滚动条 
			"sScrollXInner" : "100%",
			"bScrollCollapse" : true,
			"aoColumns" : [],
			"aaData" : [],
			"sPaginationType": "full_numbers", //分页样式
			"bAutoWidth" : true, //列的宽度会根据table的宽度自适应 
			"bSort" : false, //是否使用排序 
			"aoColumnDefs" : [ {
				"bSortable" : false,
				"aTargets" :["_all"]
			} ],
			"aaSorting" : [ [ 4, "desc" ] ],
			"oLanguage" : _defaultDataTableOLanguage
		};
  
$(document).ready(function() {
	
	header('submitall');
	
	var pid = getQueryString('pid');
	var name = getQueryString('name');
	if(pid==null||pid==''){
		alert('错误，没有产品ID');
		return;
	}
	
	
	$('div#title').html('<h2>'+name+'<small>投标详情</small></h2>');
	
	
	
	

	var submitService = EasyServiceClient.getRemoteProxy("/easyservice/gpps.service.ISubmitService");
	var columns = [ {
		"sTitle" : "投资人",
			"code" : "name"
	}, {
		"sTitle" : "金额",
		"code" : "amount"
	}, {
		"sTitle" : "时间",
		"code" : "time"
	}];
	
	var fnServerData = function(sSource, aoData, fnCallback, oSettings) {
		var sEcho = "";
		var iDisplayStart = 0;
		var iDisplayLength = 0;
		for ( var i = 0; i < aoData.length; i++) {
			var data = aoData[i];
			if (data.name == "sEcho")
				sEcho = data.value;
			if (data.name == "iDisplayStart")
				iDisplayStart = data.value;
			if (data.name == "iDisplayLength")
				iDisplayLength = data.value;
		}
		var res = null;
		res = submitService.findPayedSubmitsByProduct(parseInt(pid), iDisplayStart, iDisplayLength);
		var result = {};
		result.iTotalRecords = res.get('total');
		result.iTotalDisplayRecords = res.get('total');
		result.aaData = new Array();
		var subs = res.get('result');
		for(var i=0; i<subs.size(); i++){
			result.aaData.push([subs.get(i).lenderName, 
			                    subs.get(i).amount.value, 
			                    formatDate(subs.get(i).createtime)]);
		}
		result.sEcho = sEcho;
		fnCallback(result);

		return res;
	}
	var mySettings = $.extend({}, defaultSettings, {
		"aoColumns" : columns,
		"fnServerData" : fnServerData
	});
	$('table#submitall').dataTable(mySettings);
})
</script>
  
</html>
